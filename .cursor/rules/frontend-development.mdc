# å‰ç«¯å¼€å‘è§„èŒƒ (Next.js + React + TypeScript)

## ğŸ“‚ æ–‡ä»¶ç»„ç»‡è§„èŒƒ

### é¡µé¢ç»„ä»¶ ([`web/app/`](mdc:web/app/))
```typescript
// app/(è·¯ç”±åˆ†ç»„)/page.tsx - Next.js 13+ App Router
'use client'

import { FC } from 'react'
import type { PageProps } from '@/types'

const HomePage: FC<PageProps> = ({ params, searchParams }) => {
  return (
    <div className="container mx-auto px-4">
      <h1 className="text-2xl font-bold">é¦–é¡µ</h1>
    </div>
  )
}

export default HomePage
```

### é€šç”¨ç»„ä»¶ ([`web/app/components/`](mdc:web/app/components/))
```typescript
// components/ui/Button.tsx
import { FC, ButtonHTMLAttributes } from 'react'
import { clsx } from 'clsx'

interface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'primary' | 'secondary' | 'danger'
  size?: 'sm' | 'md' | 'lg'
  loading?: boolean
}

export const Button: FC<ButtonProps> = ({
  variant = 'primary',
  size = 'md',
  loading = false,
  children,
  className,
  disabled,
  ...props
}) => {
  return (
    <button
      className={clsx(
        'inline-flex items-center justify-center font-medium transition-colors',
        'focus:outline-none focus:ring-2 focus:ring-offset-2',
        {
          'bg-blue-600 text-white hover:bg-blue-700': variant === 'primary',
          'bg-gray-200 text-gray-900 hover:bg-gray-300': variant === 'secondary',
          'bg-red-600 text-white hover:bg-red-700': variant === 'danger',
        },
        {
          'px-2 py-1 text-sm': size === 'sm',
          'px-4 py-2': size === 'md',
          'px-6 py-3 text-lg': size === 'lg',
        },
        className
      )}
      disabled={disabled || loading}
      {...props}
    >
      {loading && <LoadingSpinner className="mr-2" />}
      {children}
    </button>
  )
}
```

### è‡ªå®šä¹‰Hooks ([`web/hooks/`](mdc:web/hooks/))
```typescript
// hooks/use-api.ts
import { useState, useEffect } from 'react'
import { ApiResponse } from '@/types'

interface UseApiOptions<T> {
  immediate?: boolean
  onSuccess?: (data: T) => void
  onError?: (error: Error) => void
}

export function useApi<T>(
  apiCall: () => Promise<ApiResponse<T>>,
  options: UseApiOptions<T> = {}
) {
  const { immediate = false, onSuccess, onError } = options
  const [data, setData] = useState<T | null>(null)
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState<Error | null>(null)

  const execute = async () => {
    try {
      setLoading(true)
      setError(null)
      const response = await apiCall()
      setData(response.data)
      onSuccess?.(response.data)
    } catch (err) {
      const error = err as Error
      setError(error)
      onError?.(error)
    } finally {
      setLoading(false)
    }
  }

  useEffect(() => {
    if (immediate) {
      execute()
    }
  }, [immediate])

  return { data, loading, error, execute }
}
```

### APIæœåŠ¡å±‚ ([`web/service/`](mdc:web/service/))
```typescript
// service/user.ts
import { api } from './base'
import type { User, CreateUserRequest } from '@/types'

export const userService = {
  /**
   * è·å–ç”¨æˆ·åˆ—è¡¨
   */
  async getUsers(params?: { page?: number; limit?: number }) {
    return api.get<User[]>('/users', { params })
  },

  /**
   * åˆ›å»ºç”¨æˆ·
   */
  async createUser(data: CreateUserRequest) {
    return api.post<User>('/users', data)
  },

  /**
   * è·å–ç”¨æˆ·è¯¦æƒ…
   */
  async getUserById(id: string) {
    return api.get<User>(`/users/${id}`)
  }
}
```

## ğŸ¨ æ ·å¼è§„èŒƒ

### 1. TailwindCSS ä½¿ç”¨è§„èŒƒ
```typescript
// ä½¿ç”¨clsxåˆå¹¶ç±»å
import { clsx } from 'clsx'

const Card: FC<{ active?: boolean }> = ({ active, children }) => (
  <div className={clsx(
    'rounded-lg border p-4 shadow-sm transition-colors',
    'hover:shadow-md focus:outline-none focus:ring-2',
    {
      'bg-blue-50 border-blue-200': active,
      'bg-white border-gray-200': !active,
    }
  )}>
    {children}
  </div>
)
```

### 2. å“åº”å¼è®¾è®¡
```typescript
// ç§»åŠ¨ä¼˜å…ˆçš„å“åº”å¼è®¾è®¡
<div className="
  grid grid-cols-1 gap-4
  sm:grid-cols-2 sm:gap-6
  lg:grid-cols-3 lg:gap-8
  xl:grid-cols-4
">
  {items.map(item => <Card key={item.id} {...item} />)}
</div>
```

## ğŸ”§ çŠ¶æ€ç®¡ç†

### 1. Zustand Store
```typescript
// store/app-store.ts
import { create } from 'zustand'
import { devtools } from 'zustand/middleware'

interface AppState {
  user: User | null
  theme: 'light' | 'dark'
  sidebarOpen: boolean
  
  // Actions
  setUser: (user: User | null) => void
  toggleTheme: () => void
  toggleSidebar: () => void
}

export const useAppStore = create<AppState>()(
  devtools(
    (set, get) => ({
      user: null,
      theme: 'light',
      sidebarOpen: false,
      
      setUser: (user) => set({ user }, false, 'setUser'),
      toggleTheme: () => set(
        (state) => ({ theme: state.theme === 'light' ? 'dark' : 'light' }),
        false,
        'toggleTheme'
      ),
      toggleSidebar: () => set(
        (state) => ({ sidebarOpen: !state.sidebarOpen }),
        false,
        'toggleSidebar'
      ),
    }),
    { name: 'app-store' }
  )
)
```

### 2. React Hook Form
```typescript
// è¡¨å•å¤„ç†
import { useForm } from 'react-hook-form'
import { zodResolver } from '@hookform/resolvers/zod'
import { z } from 'zod'

const userSchema = z.object({
  email: z.string().email('è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'),
  password: z.string().min(6, 'å¯†ç è‡³å°‘6ä¸ªå­—ç¬¦'),
  name: z.string().min(1, 'è¯·è¾“å…¥å§“å'),
})

type UserFormData = z.infer<typeof userSchema>

const UserForm: FC = () => {
  const {
    register,
    handleSubmit,
    formState: { errors, isSubmitting },
  } = useForm<UserFormData>({
    resolver: zodResolver(userSchema),
  })

  const onSubmit = async (data: UserFormData) => {
    try {
      await userService.createUser(data)
      // å¤„ç†æˆåŠŸ
    } catch (error) {
      // å¤„ç†é”™è¯¯
    }
  }

  return (
    <form onSubmit={handleSubmit(onSubmit)} className="space-y-4">
      <div>
        <input
          {...register('email')}
          type="email"
          placeholder="é‚®ç®±"
          className="w-full px-3 py-2 border rounded-md"
        />
        {errors.email && (
          <p className="mt-1 text-sm text-red-600">{errors.email.message}</p>
        )}
      </div>
      
      <Button type="submit" loading={isSubmitting}>
        æäº¤
      </Button>
    </form>
  )
}
```

## ğŸŒ å›½é™…åŒ–

### 1. ä½¿ç”¨i18next
```typescript
// hooks/use-translation.ts
import { useTranslation } from 'react-i18next'

export const useI18n = () => {
  const { t, i18n } = useTranslation()
  
  return {
    t,
    locale: i18n.language,
    changeLocale: (locale: string) => i18n.changeLanguage(locale),
  }
}

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
const Welcome: FC = () => {
  const { t } = useI18n()
  
  return (
    <div>
      <h1>{t('welcome.title')}</h1>
      <p>{t('welcome.description')}</p>
    </div>
  )
}
```

## ğŸ›¡ï¸ ç±»å‹å®‰å…¨

### 1. APIç±»å‹å®šä¹‰
```typescript
// types/api.ts
export interface ApiResponse<T = any> {
  success: boolean
  data: T
  message?: string
  code?: string
}

export interface PaginatedResponse<T> {
  items: T[]
  total: number
  page: number
  limit: number
  hasMore: boolean
}

// types/user.ts
export interface User {
  id: string
  email: string
  name: string
  avatar?: string
  createdAt: string
  updatedAt: string
}

export interface CreateUserRequest {
  email: string
  password: string
  name: string
}
```

### 2. ç»„ä»¶Propsç±»å‹
```typescript
// ä¸¥æ ¼çš„ç»„ä»¶ç±»å‹å®šä¹‰
interface UserCardProps {
  user: User
  showActions?: boolean
  onEdit?: (user: User) => void
  onDelete?: (userId: string) => void
  className?: string
}

const UserCard: FC<UserCardProps> = ({
  user,
  showActions = true,
  onEdit,
  onDelete,
  className
}) => {
  // ç»„ä»¶å®ç°
}
```

## ğŸš« é¿å…çš„åæ¨¡å¼

1. **ä¸è¦**åœ¨ç»„ä»¶ä¸­å†™å¤æ‚çš„ä¸šåŠ¡é€»è¾‘
2. **ä¸è¦**ç›´æ¥ä¿®æ”¹propsæˆ–state
3. **ä¸è¦**å¿˜è®°å¤„ç†loadingå’ŒerrorçŠ¶æ€
4. **ä¸è¦**ä½¿ç”¨anyç±»å‹ï¼ˆé™¤éç¡®å®å¿…è¦ï¼‰
5. **ä¸è¦**åœ¨useEffectä¸­å¿˜è®°æ¸…ç†å‰¯ä½œç”¨

## ğŸ“ æ³¨é‡Šè§„èŒƒ

```typescript
/**
 * å¤æ‚çš„ç”¨æˆ·æ•°æ®å¤„ç†ç»„ä»¶
 * 
 * è¿™ä¸ªç»„ä»¶å¤„ç†ç”¨æˆ·æ•°æ®çš„å±•ç¤ºå’Œç¼–è¾‘ï¼ŒåŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
 * 1. ç”¨æˆ·ä¿¡æ¯å±•ç¤º
 * 2. å†…è”ç¼–è¾‘åŠŸèƒ½
 * 3. å¤´åƒä¸Šä¼ 
 * 4. æƒé™æ§åˆ¶
 */
interface UserProfileProps {
  userId: string
  editable?: boolean
  onUpdate?: (user: User) => void
}

const UserProfile: FC<UserProfileProps> = ({ userId, editable, onUpdate }) => {
  // è·å–ç”¨æˆ·æ•°æ®
  const { data: user, loading, error } = useApi(
    () => userService.getUserById(userId),
    { immediate: true }
  )

  // å¤„ç†ç¼–è¾‘æ¨¡å¼åˆ‡æ¢
  const [isEditing, setIsEditing] = useState(false)
  
  // å¤æ‚çš„è¡¨å•å¤„ç†é€»è¾‘
  const handleSubmit = useCallback(async (formData: UserFormData) => {
    try {
      // æ•°æ®éªŒè¯å’Œæäº¤
      const updatedUser = await userService.updateUser(userId, formData)
      onUpdate?.(updatedUser)
      setIsEditing(false)
    } catch (error) {
      // é”™è¯¯å¤„ç†
      console.error('æ›´æ–°ç”¨æˆ·å¤±è´¥:', error)
    }
  }, [userId, onUpdate])

  // ç»„ä»¶æ¸²æŸ“é€»è¾‘
  if (loading) return <UserProfileSkeleton />
  if (error) return <ErrorMessage error={error} />
  if (!user) return <NotFound />

  return (
    // JSXå†…å®¹
  )
}
```

## ğŸ§ª ä¸ä¸»åŠ¨è¿è¡Œæµ‹è¯•

æ ¹æ®ç”¨æˆ·è¦æ±‚ï¼Œå¼€å‘å®Œæˆå**ä¸è¦ä¸»åŠ¨è¿è¡Œæµ‹è¯•å‘½ä»¤**ï¼Œä½†ä»£ç åº”è¯¥æ˜“äºæµ‹è¯•ï¼š

```typescript
// ç¼–å†™å¯æµ‹è¯•çš„çº¯å‡½æ•°
export const formatUserName = (user: User): string => {
  return user.name || user.email.split('@')[0]
}

// ç¼–å†™å¯æµ‹è¯•çš„ç»„ä»¶
export const UserCard: FC<UserCardProps> = ({ user, onEdit }) => {
  return (
    <div data-testid="user-card">
      <h3>{formatUserName(user)}</h3>
      <button onClick={() => onEdit?.(user)}>ç¼–è¾‘</button>
    </div>
  )
}
```
description: å‰ç«¯å¼€å‘è§„åˆ™
globs:
alwaysApply: false
---
